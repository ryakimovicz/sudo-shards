<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Jigsudo</title>

    <!-- Global Styles -->
    <link rel="stylesheet" href="css/global.css" />

    <!-- Module Styles -->
    <link rel="stylesheet" href="css/home.css" />
    <link rel="stylesheet" href="css/memory.css" />
    <link rel="stylesheet" href="css/jigsaw.css" />
    <link rel="stylesheet" href="css/sudoku.css" />
    <link rel="stylesheet" href="css/peaks.css" />
    <link rel="stylesheet" href="css/search.css" />
    <link rel="stylesheet" href="css/code.css" />
    <link rel="stylesheet" href="css/auth.css" />
    <link rel="stylesheet" href="css/profile.css?v=40" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;700&family=Lora:ital,wght@0,400;0,600;1,400&display=swap"
      rel="stylesheet"
    />
    <link
      rel="icon"
      type="image/svg+xml"
      href="assets/images/favicon_light.svg"
      media="(prefers-color-scheme: light)"
    />
    <link
      rel="icon"
      type="image/svg+xml"
      href="assets/images/favicon_dark.svg"
      media="(prefers-color-scheme: dark)"
    />

    <!-- Social Media / Open Graph -->
    <meta property="og:title" content="Jigsudo - Desaf√≠a tu mente" />
    <meta
      property="og:description"
      content="Resuelve el puzzle diario. Una combinaci√≥n √∫nica de l√≥gica y rompecabezas. ¬øPodr√°s completarlo?"
    />
    <meta property="og:image" content="https://jigsudo.web.app/assets/images/social-preview.png" />
    <meta property="og:url" content="https://jigsudo.web.app" />
    <meta property="og:type" content="website" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Jigsudo - Puzzle Diario" />
    <meta
      name="twitter:description"
      content="Juega Jigsudo gratis. El desaf√≠o diario que entrena tu cerebro."
    />
    <meta name="twitter:image" content="https://jigsudo.web.app/assets/images/social-preview.png" />
  </head>
  <body>
    <script>
      (function () {
        const saved = localStorage.getItem("jigsudo_theme");
        const sysDark = window.matchMedia(
          "(prefers-color-scheme: dark)",
        ).matches;
        if (
          saved === "dark" ||
          (!saved && sysDark) ||
          (saved === "auto" && sysDark)
        ) {
          document.body.classList.add("dark-mode");
        }
      })();
    </script>
    <!-- Main Application Container -->
    <div id="app">
      <!-- Header -->
      <header class="main-header">
        <div class="header-left">
          <h1 class="app-title">Jigsudo</h1>
          <div class="header-info">
            <span id="current-date"></span>
            <span id="challenge-num"></span>
          </div>
        </div>

        <div class="header-right">

          <div class="settings-wrapper" style="position: relative">
            <button
              id="btn-profile"
              class="btn-icon"
              aria-label="Perfil"
              data-i18n-aria="header_profile_label"
            >
              ‚öôÔ∏è
            </button>
            <!-- Profile Dropdown -->
            <div
              id="profile-dropdown"
              class="dropdown-content glass-panel hidden"
            >
              <!-- HEADER -->
              <h3 class="dropdown-header" data-i18n="settings_title">
                Configuraci√≥n
              </h3>

              <!-- SECTION: ACCOUNT -->
              <div class="settings-section account-section">
                <h4 class="settings-subhead" data-i18n="settings_account">
                  Cuenta
                </h4>
                <!-- Login State (Toggled by JS) -->
                <div id="login-wrapper">
                  <!-- Guest Profile Access -->
                  <div
                    class="user-info-row centered"
                    style="margin-bottom: 12px"
                  >
                    <button
                      id="btn-guest-profile"
                      class="btn-profile-link"
                      title="Ver Perfil de Invitado"
                    >
                      <span
                        class="user-avatar-placeholder"
                        style="background: #e2e8f0; color: #64748b"
                        >üë§</span
                      >
                      <strong>Invitado</strong>
                    </button>
                  </div>

                  <button
                    id="btn-login-trigger"
                    class="btn-secondary full-width"
                    data-i18n="btn_login_menu"
                  >
                    Iniciar Sesi√≥n
                  </button>
                </div>

                <div id="logged-in-view" class="hidden">
                  <div class="user-info-row centered">
                    <button
                      id="btn-view-profile"
                      class="btn-profile-link"
                      title="Ver Perfil"
                    >
                      <span class="user-avatar-placeholder">üë§</span>
                      <strong id="user-display-name">Usuario</strong>
                    </button>
                  </div>
                </div>
              </div>

              <div class="dropdown-divider"></div>

              <!-- SECTION: APPEARANCE -->
              <div class="settings-section appearance-section">
                <h4 class="settings-subhead" data-i18n="settings_appearance">
                  Apariencia
                </h4>
                <div class="segmented-control theme-switcher">
                  <label class="segment-label">
                    <input type="radio" name="theme" value="light" />
                    <span class="segment-content">
                      <span class="icon">‚òÄÔ∏è</span>
                      <span class="text" data-i18n="theme_light">Claro</span>
                    </span>
                  </label>
                  <label class="segment-label">
                    <input type="radio" name="theme" value="auto" />
                    <span class="segment-content">
                      <span class="icon">üåó</span>
                      <span class="text" data-i18n="theme_auto">Auto</span>
                    </span>
                  </label>
                  <label class="segment-label">
                    <input type="radio" name="theme" value="dark" />
                    <span class="segment-content">
                      <span class="icon">üåô</span>
                      <span class="text" data-i18n="theme_dark">Oscuro</span>
                    </span>
                  </label>
                </div>
              </div>

              <div class="dropdown-divider"></div>

              <!-- SECTION: GAMEPLAY -->
              <div class="settings-section gameplay-section">
                <h4 class="settings-subhead" data-i18n="settings_gameplay">
                  Jugabilidad
                </h4>

                <!-- Sound -->
                <div class="setting-item">
                  <span class="setting-label">
                    <span class="icon-label">üîä</span>
                    <span data-i18n="setting_sound">Sonido</span>
                  </span>
                  <label class="switch-small">
                    <input type="checkbox" id="sound-toggle" checked />
                    <span class="slider-small round"></span>
                  </label>
                </div>

                <!-- Vibration (Mobile Only via JS) -->
                <div class="setting-item" id="setting-vibration-container">
                  <span class="setting-label">
                    <span class="icon-label">üì≥</span>
                    <span data-i18n="setting_vibration">Vibraci√≥n</span>
                  </span>
                  <label class="switch-small">
                    <input type="checkbox" id="vibration-toggle" checked />
                    <span class="slider-small round"></span>
                  </label>
                </div>

                <!-- Confirm Clear -->
                <div class="setting-item">
                  <div class="label-group">
                    <span class="setting-label">
                      <span class="icon-label">üõ°Ô∏è</span>
                      <span data-i18n="setting_confirm_clear"
                        >Confirmar Borrado</span
                      >
                    </span>
                    <!-- <small class="setting-desc" data-i18n="setting_confirm_desc">Evita borrar todo por error</small> -->
                  </div>
                  <label class="switch-small">
                    <input type="checkbox" id="confirm-clear-toggle" checked />
                    <span class="slider-small round"></span>
                  </label>
                </div>

                <!-- Language -->
                <div class="setting-item">
                  <span class="setting-label" data-i18n="profile_language"
                    >Idioma</span
                  >
                  <select id="language-select" class="lang-select">
                    <option value="es">Espa√±ol</option>
                    <option value="en">English</option>
                  </select>
                </div>
                </div>



                <!-- SECTION: SUPPORT -->
                <div class="settings-section" style="margin-top: 15px; text-align: center;">
                  <button id="btn-report-bug" class="btn-report-bug" data-i18n="btn_report_bug" onclick="window.openBugReportModal()">
                    Reportar Bug üêõ
                  </button>
                  <button id="btn-share-app" class="btn-report-bug" data-i18n="btn_share_app" onclick="window.shareApp()" style="margin-top: 10px; border-color: var(--accent-color); color: var(--accent-color);">
                    Compartir App üì¢
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </header>

      <!-- Main Menu Content -->
      <main id="menu-content" class="menu-container">
        <!-- Logo Section -->
        <div class="home-logo-container">
          <img
            src="assets/images/logo_lightmode.svg"
            alt="Jigsudo Logo"
            class="home-logo light-mode-logo"
          />
          <img
            src="assets/images/logo_darkmode.svg"
            alt="Jigsudo Logo"
            class="home-logo dark-mode-logo"
          />
          <h1 class="home-logo-text">Jigsudo</h1>
        </div>

        <div class="tabs-group">
          <!-- Tabs -->
          <div class="home-tabs">
            <button
              class="tab-btn active"
              data-tab="daily"
              data-i18n="tab_daily"
            >
              Diario
            </button>
            <button class="tab-btn" data-tab="custom" data-i18n="tab_custom">
              Personalizado
            </button>
          </div>

          <!-- Panels Container -->
          <div class="home-panels">
            <!-- Daily Panel (Default) -->
            <section
              id="panel-daily"
              class="game-description glass-panel active"
            >
              <h2 data-i18n="menu_title">Seis desaf√≠os, un solo tablero</h2>
              <p data-i18n-html="menu_description_html">
                Todo empieza con el <strong>Juego de Memoria</strong>: encuentra
                los pares, consigue las piezas y arma el
                <strong>Rompecabezas</strong>. Solo as√≠ podr√°s enfrentar al
                <strong>Sudoku</strong>, superar los
                <strong>Picos y Valles</strong>, buscar en la
                <strong>Sopa de N√∫meros</strong> y descifrar
                <strong>El C√≥digo</strong> final.
              </p>
              <p class="tagline" data-i18n="menu_tagline">
                Tu dosis diaria de n√∫meros te est√° esperando
              </p>
            </section>

            <!-- Custom Panel (Overlay) -->
            <section
              id="panel-custom"
              class="game-description glass-panel custom-panel"
            >
              <div class="custom-content">
                <!-- Section: Difficulty -->
                <h3 class="panel-section-title" data-i18n="custom_difficulty">
                  Dificultad
                </h3>

                <div class="difficulty-wrapper">
                  <div class="segmented-control">
                    <button
                      class="seg-btn"
                      data-diff="easy"
                      data-i18n="diff_easy"
                    >
                      F√°cil
                    </button>
                    <button
                      class="seg-btn active"
                      data-diff="normal"
                      data-i18n="diff_normal"
                    >
                      Normal
                    </button>
                    <button
                      class="seg-btn"
                      data-diff="hard"
                      data-i18n="diff_hard"
                    >
                      Dif√≠cil
                    </button>
                    <button
                      class="seg-btn"
                      data-diff="extreme"
                      data-i18n="diff_extreme"
                    >
                      Extremo
                    </button>
                  </div>
                </div>

                <!-- Section: Game Modes -->
                <h3 class="panel-section-title" data-i18n="custom_modes">
                  Modos de juego
                </h3>

                <!-- Game List -->
                <div class="game-switches-list">
                  <div class="switch-row">
                    <span data-i18n="game_memory">Memory</span>
                    <label class="switch-small">
                      <input type="checkbox" checked />
                      <span class="slider-small round"></span>
                    </label>
                  </div>
                  <div class="switch-row">
                    <span data-i18n="game_jigsaw">Jigsaw</span>
                    <label class="switch-small">
                      <input type="checkbox" checked />
                      <span class="slider-small round"></span>
                    </label>
                  </div>
                  <div class="switch-row">
                    <span data-i18n="game_sudoku">Sudoku</span>
                    <label class="switch-small">
                      <input type="checkbox" checked />
                      <span class="slider-small round"></span>
                    </label>
                  </div>
                  <div class="switch-row">
                    <span data-i18n="game_peaks">Peaks</span>
                    <label class="switch-small">
                      <input type="checkbox" checked />
                      <span class="slider-small round"></span>
                    </label>
                  </div>
                  <div class="switch-row">
                    <span data-i18n="game_search">Search</span>
                    <label class="switch-small">
                      <input type="checkbox" checked />
                      <span class="slider-small round"></span>
                    </label>
                  </div>
                  <div class="switch-row">
                    <span data-i18n="game_code">Code</span>
                    <label class="switch-small">
                      <input type="checkbox" checked />
                      <span class="slider-small round"></span>
                    </label>
                  </div>
                </div>
              </div>
            </section>
          </div>
        </div>

        <button
          id="start-btn"
          class="btn-primary"
          data-i18n="btn_start"
          disabled
        >
          JUGAR
        </button>

        <!-- Ranking Section -->
        <section id="ranking-container" class="ranking-container-multi">
          <div class="ranking-header-main">
            <h3 data-i18n="ranking_title">Clasificaci√≥n</h3>
            <button id="btn-refresh-ranking" class="btn-refresh" title="Actualizar">
              üîÑ
            </button>
          </div>
          
          <div class="ranking-grid">
            <!-- Daily -->
            <div class="ranking-panel glass-panel active">
              <h4 data-i18n="rank_tab_daily">Hoy</h4>
              <div id="ranking-daily-wrapper" class="ranking-table-wrapper">
                <div class="loader-small"></div>
              </div>
            </div>

            <!-- Monthly -->
            <div class="ranking-panel glass-panel active">
              <h4 data-i18n="rank_tab_monthly">Mes</h4>
              <div id="ranking-monthly-wrapper" class="ranking-table-wrapper">
                <div class="loader-small"></div>
              </div>
            </div>

            <!-- All Time -->
            <div class="ranking-panel glass-panel active">
              <h4 data-i18n="rank_tab_all">Siempre</h4>
              <div id="ranking-alltime-wrapper" class="ranking-table-wrapper">
                <div class="loader-small"></div>
              </div>
            </div>
          </div>
        </section>
      </main>

      <!-- Profile Section -->
      <section id="profile-section" class="hidden">
        <div class="scrollable-content">
          <!-- 1. Identity Card -->
          <div class="profile-card identity-card glass-panel">
            <div class="profile-avatar-large" id="profile-avatar">U</div>
            <div class="profile-identity">
              <h2 id="profile-username">Usuario</h2>
              <div class="rank-display">
                <div class="rank-header-row">
                  <span class="rank-icon" id="profile-rank-icon">üå±</span>
                  <span class="rank-title" id="profile-rank-name">Novato</span>
                </div>

                <div class="rank-progress-container">
                  <div class="rank-progress-bar">
                    <div
                      class="rank-progress-fill"
                      id="profile-rank-progress"
                      style="width: 0%"
                    ></div>
                  </div>
                  <div class="rank-details-row">
                    <span class="rank-level" id="profile-rank-level"
                      >Nvl. 0</span
                    >
                    <span class="rank-points"
                      ><span id="profile-rp-current">0</span> /
                      <span id="profile-rp-next">15000</span> RP</span
                    >
                  </div>
                </div>
              </div>
            </div>
            <!-- Future: Edit Button -->
          </div>

          <!-- 2. Statistics Grid (Wordle Style) -->
          <!-- 2-Column Layout (Stats Left, Calendar Right) -->
          <!-- 1. Stats Overview -->
          <div class="section-title" data-i18n="stats_title">Estad√≠sticas</div>
          <div class="stats-grid overview">
            <!-- Row 1: Activity -->
            <div class="stat-box">
              <span class="stat-number" id="stat-played">0</span>
              <span class="stat-label" data-i18n="stat_days">Jugadas</span>
            </div>
            <div class="stat-box">
              <span class="stat-number" id="stat-streak">0</span>
              <span class="stat-label" data-i18n="stat_streak">Racha Actual</span>
            </div>
            <div class="stat-box">
              <span class="stat-number" id="stat-max-streak">0</span>
              <span class="stat-label" data-i18n="stat_max_streak">Racha M√°x.</span>
            </div>

            <!-- Row 2: Performance -->
            <div class="stat-box">
              <span class="stat-number" id="stat-max-score">0</span>
              <span class="stat-label" data-i18n="stat_max_score">Puntaje M√°x.</span>
            </div>
            <div class="stat-box">
              <span class="stat-number" id="stat-best-time">--:--</span>
              <span class="stat-label" data-i18n="stat_best_time">Tiempo R√©cord</span>
            </div>
            <div class="stat-box">
              <span class="stat-number" id="stat-avg-time">--:--</span>
              <span class="stat-label" data-i18n="stat_avg_time">Tiempo Prom.</span>
            </div>
          </div>

          <!-- 2. Detailed Stage Stats -->
          <div
            class="section-title sub-title"
            id="stats-details-title"
            style="
              margin-top: 24px;
              margin-bottom: 8px;
              font-size: 0.9rem;
              opacity: 0.8;
            "
            data-i18n="stats_details_title"
          >
            Tiempos por Juego (Promedio)
          </div>
          <div class="stats-grid details">
            <div class="stat-detail-box">
              <span class="detail-label" data-i18n="p_game_memory">Memoria</span>
              <span class="detail-value" id="stat-avg-memory">--</span>
            </div>
            <div class="stat-detail-box">
              <span class="detail-label" data-i18n="p_game_jigsaw">Rompecabezas</span>
              <span class="detail-value" id="stat-avg-jigsaw">--</span>
            </div>
            <div class="stat-detail-box">
              <span class="detail-label" data-i18n="p_game_sudoku">Sudoku</span>
              <span class="detail-value" id="stat-avg-sudoku">--</span>
            </div>
            <div class="stat-detail-box">
              <span class="detail-label" data-i18n="p_game_peaks">Picos y Valles</span>
              <div class="detail-multi">
                <span id="stat-avg-peaks">--</span>
                <span class="detail-sub" id="stat-avg-peaks-err"></span>
              </div>
            </div>
            <div class="stat-detail-box">
              <span class="detail-label" data-i18n="p_game_search">Sopa N√∫meros</span>
              <span class="detail-value" id="stat-avg-search">--</span>
            </div>
            <div class="stat-detail-box">
              <span class="detail-label" data-i18n="p_game_code">El C√≥digo</span>
              <span class="detail-value" id="stat-avg-code">--</span>
            </div>
          </div>

          <!-- 3. History & Analysis (Row) -->
          <div class="stats-grid history-grid-row" style="margin-top: 24px">
            <!-- Calendar -->
            <div class="calendar-heatmap" style="margin-top: 0 !important">
              <div class="calendar-header">
                <button id="cal-prev-btn" class="icon-btn-small">‚Üê</button>
                <div
                  class="section-title history-title"
                  id="cal-month-label"
                  data-i18n="history_title"
                >
                  Historial
                </div>
                <button id="cal-next-btn" class="icon-btn-small">‚Üí</button>
              </div>
              <div class="calendar-grid" id="calendar-grid">
                <!-- JS will populate days -->
              </div>
            </div>

            <!-- Weekday Stats -->
            <div class="daily-time-report" style="margin-top: 0 !important">
              <div
                class="calendar-header"
                style="
                  width: 100%;
                  justify-content: center;
                  min-height: 32px;
                  margin-bottom: 12px;
                "
              >
              >
                <div class="section-title history-title" data-i18n="daily_avg_title">Promedio Diario</div>
              </div>
              <div class="daily-time-chart" id="daily-time-chart">
                <!-- Chart -->
              </div>
            </div>
          </div>

          <!-- 4. Settings / Actions -->
          <div class="section-title" data-i18n="settings_title">Ajustes</div>
          <div class="profile-actions hidden">
            <div
              id="profile-email-display"
              style="
                text-align: center;
                margin-bottom: 20px;
                color: var(--text-muted);
                font-size: 0.9rem;
              "
            ></div>

            <button
              id="btn-profile-change-name"
              class="btn-secondary full-width"
              data-i18n="btn_change_username"
            >
              Cambiar Nombre
            </button>

            <button
              id="btn-profile-change-pw"
              class="btn-secondary full-width"
              data-i18n="btn_change_password"
            >
              Cambiar Contrase√±a
            </button>

            <button
              id="btn-profile-logout"
              class="btn-danger full-width"
              data-i18n="btn_logout"
            >
              Cerrar Sesi√≥n
            </button>

            <button
              id="btn-profile-delete"
              class="btn-delete-danger full-width"
              style="
                margin-top: 25px;
                border: 1px solid #ff5555;
                background: transparent;
                color: #ff5555;
                opacity: 0.8;
              "
              data-i18n="btn_delete_account"
            >
              Eliminar Cuenta
            </button>
          </div>

          <!-- Guest Actions (Visible only when logged out) -->
          <div class="guest-actions hidden">
            <div
              style="
                text-align: center;
                margin-bottom: 20px;
                color: var(--text-muted);
                font-size: 0.9rem;
              "
            >
              Inicia sesi√≥n para guardar tu progreso y aparecer en el ranking.
            </div>
            <button
              id="btn-profile-login-guest"
              class="btn-primary full-width"
              style="margin-top: 10px"
            >
              Iniciar Sesi√≥n
            </button>
          </div>
        </div>
      </section>

      <!-- Game Section (Sudoku/Jigsaw) -->
      <section id="game-section" class="hidden">
        <!-- TEST PANELS FOR MOBILE -->
        <div class="test-mobile-panels">
          <div class="test-panel red"></div>
          <div class="test-panel yellow"></div>
          <div class="test-panel green"></div>
        </div>

        <header class="game-header">
          <div class="header-title-container">
            <h2 data-i18n="game_memory">Juego de Memoria</h2>
            <div class="info-icon-wrapper">
              <span class="info-icon">i</span>
            </div>
            <div class="info-tooltip">
              <h3 data-i18n="memory_help_title">C√≥mo jugar</h3>
              <p data-i18n-html="memory_help_desc">
                Encuentra los pares de bloques sudoku.<br />Cada par revelado se
                colocar√° en el tablero o en tu colecci√≥n.
              </p>
            </div>
          </div>
        </header>

        <div class="memory-grid-layout">
          <!-- Center Area: Board -->
          <div class="board-wrapper">
            <div id="memory-board" class="memory-board"></div>
          </div>

          <!-- Collected Pieces Wrapper -->
          <div class="collected-wrapper">
            <div id="collected-left" class="collected-zone left"></div>
            <div id="collected-right" class="collected-zone right"></div>
          </div>

          <!-- Cards Area -->
          <div id="memory-cards" class="cards-area"></div>

          <!-- Sudoku Controls (Keypad) -->
          <div id="sudoku-controls" class="sudoku-controls hidden">
            <div class="control-row secondary">
              <button id="sudoku-back" class="btn-sudoku-action">
                <span class="icon">‚Ü©Ô∏è</span>
              </button>
              <button id="sudoku-pencil" class="btn-sudoku-action">
                <span class="icon">‚úèÔ∏è</span>
              </button>
              <button id="sudoku-clear" class="btn-sudoku-action">
                <span class="icon">üóëÔ∏è</span>
              </button>
            </div>
            <div class="control-row primary numbers">
              <button class="sudoku-num" data-value="1">1</button>
              <button class="sudoku-num" data-value="2">2</button>
              <button class="sudoku-num" data-value="3">3</button>
              <button class="sudoku-num" data-value="4">4</button>
              <button class="sudoku-num" data-value="5">5</button>
              <button class="sudoku-num" data-value="6">6</button>
              <button class="sudoku-num" data-value="7">7</button>
              <button class="sudoku-num" data-value="8">8</button>
              <button class="sudoku-num" data-value="9">9</button>
            </div>
          </div>

          <!-- Peaks Error Counter -->
          <div id="peaks-stats" class="peaks-stats hidden">
            <span class="remaining-label" data-i18n="peaks_remaining"
              >Faltan:</span
            >
            <span id="peaks-remaining-count">0</span>
            <span class="separator">|</span>
            <span class="error-label" data-i18n="peaks_errors">Errores:</span>
            <span id="peaks-error-count">0</span>
          </div>
        </div>

        <!-- Timer -->
        <div id="memory-timer" class="memory-timer">00:00</div>
      </section>

      <!-- Footer -->
      <footer class="main-footer">
        <p>
          <span data-i18n="footer_rights">¬© 2026 Rom√°n Yakimovicz</span> |
          <a href="https://github.com/ryakimovicz/" target="_blank">GitHub</a>
        </p>
      </footer>

      <!-- Sidebar Removed -->
    </div>

    <!-- Global Scripts -->
    <!-- game-manager and other modules are imported by main.js or each other. 
         Removing explicit tags to prevent double-loading (e.g. ?v=1.1 mismatch). -->

    <!-- Entry Point -->
    <script type="module" src="js/main.js?v=999"></script>
    <!-- Entry Point -->

    <!-- Confirmation Modal -->
    <div id="confirm-modal" class="modal-overlay hidden">
      <div class="modal-content glass-panel">
        <h3 id="modal-title" class="modal-title" data-i18n="modal_clear_title">
          Reiniciar Tablero
        </h3>
        <p id="modal-desc" class="modal-desc" data-i18n="modal_clear_body">
          ¬øEst√°s seguro de que quieres borrar todos los n√∫meros?
        </p>

        <div class="modal-option">
          <label class="checkbox-label">
            <input type="checkbox" id="modal-dont-ask" />
            <span class="custom-checkbox"></span>
            <span data-i18n="modal_dont_ask">No volver a preguntar</span>
          </label>
        </div>

        <div class="modal-actions">
          <button
            id="modal-cancel"
            class="btn-secondary"
            data-i18n="btn_cancel"
          >
            Cancelar
          </button>
          <button id="modal-confirm" class="btn-danger" data-i18n="btn_clear">
            Borrar
          </button>
        </div>
      </div>
    </div>

    <!-- Login Modal -->
    <div id="login-modal" class="modal-overlay hidden">
      <div class="modal-content login-content glass-panel">
        <span class="close-modal" id="login-modal-cancel">&times;</span>
        <h2 data-i18n="login_title">Cuenta Jigsudo</h2>

        <div class="auth-forms">
          <!-- Login Form -->
          <form id="login-form" class="auth-form active">
            <input
              type="email"
              id="login-email"
              placeholder="Email"
              required
              autocomplete="email"
              class="auth-input"
            />
            <div class="password-wrapper">
              <input
                type="password"
                id="login-password"
                placeholder="Contrase√±a"
                required
                autocomplete="current-password"
                class="auth-input"
              />
              <button
                type="button"
                class="toggle-password"
                aria-label="Mostrar contrase√±a"
              >
                üëÅÔ∏è
              </button>
            </div>
            <button
              type="submit"
              class="btn-primary auth-submit"
              data-i18n="btn_login"
            >
              Iniciar Sesi√≥n
            </button>
            <p class="auth-switch">
              ¬øNo tienes cuenta?
              <a href="#" id="switch-to-register" data-i18n="link_register"
                >Reg√≠strate</a
              >
            </p>
          </form>

          <!-- Register Form -->
          <form id="register-form" class="auth-form hidden">
            <input
              type="text"
              id="register-username"
              placeholder="Nombre de usuario"
              required
              autocomplete="username"
              class="auth-input"
            />
            <input
              type="email"
              id="register-email"
              placeholder="Email"
              required
              autocomplete="email"
              class="auth-input"
            />
            <div class="password-wrapper">
              <input
                type="password"
                id="register-password"
                placeholder="Contrase√±a (min 6 chars)"
                required
                autocomplete="new-password"
                class="auth-input"
              />
              <button
                type="button"
                class="toggle-password"
                aria-label="Mostrar contrase√±a"
              >
                üëÅÔ∏è
              </button>
            </div>
            <div class="password-wrapper">
              <input
                type="password"
                id="register-password-confirm"
                placeholder="Repetir Contrase√±a"
                required
                autocomplete="new-password"
                class="auth-input"
              />
            </div>
            <button
              type="submit"
              class="btn-primary auth-submit"
              data-i18n="btn_register"
            >
              Crear Cuenta
            </button>
            <p class="auth-switch">
              ¬øYa tienes cuenta?
              <a href="#" id="switch-to-login" data-i18n="link_login"
                >Inicia Sesi√≥n</a
              >
            </p>
          </form>
        </div>
        <div id="auth-error-msg" class="error-msg hidden"></div>
      </div>
    </div>

    <!-- PASSWORD CONFIRMATION MODAL -->
    <div id="password-confirm-modal" class="modal-overlay hidden">
      <div class="modal-content small-modal">
        <h3 id="pwd-modal-title">Confirmar Contrase√±a</h3>
        <p
          id="pwd-modal-desc"
          style="
            margin-bottom: 15px;
            font-size: 0.9rem;
            color: var(--text-secondary);
          "
        >
          Para continuar, ingresa tu contrase√±a actual.
        </p>

        <!-- Generic Text Input (Hidden by default) -->
        <input
          type="text"
          id="modal-text-input"
          class="auth-input hidden"
          placeholder="Nuevo valor"
          style="margin-bottom: 10px"
        />

        <div class="password-wrapper">
          <input
            type="password"
            id="confirm-password-input"
            class="auth-input"
            placeholder="Contrase√±a actual"
          />
          <button
            class="toggle-password"
            type="button"
            tabindex="-1"
            onclick="toggleAuthPassword(this)"
          >
            üëÅÔ∏è
          </button>
        </div>

        <div
          id="new-password-container"
          class="hidden"
          style="margin-top: 10px"
        >
          <div class="password-wrapper" style="margin-bottom: 10px">
            <input
              type="password"
              id="new-password-input"
              class="auth-input"
              placeholder="Nueva contrase√±a (m√≠n 6 caracteres)"
            />
            <button
              class="toggle-password"
              type="button"
              tabindex="-1"
              onclick="toggleAuthPassword(this)"
            >
              üëÅÔ∏è
            </button>
          </div>

          <div class="password-wrapper">
            <input
              type="password"
              id="verify-password-input"
              class="auth-input"
              placeholder="Repetir nueva contrase√±a"
            />
          </div>
        </div>

        <div class="modal-actions">
          <button id="btn-cancel-pwd" class="btn-secondary">Cancelar</button>
          <button id="btn-confirm-pwd" class="btn-primary">Confirmar</button>
        </div>
      </div>
    </div>

    <!-- LOGOUT CONFIRMATION MODAL -->
    <div id="logout-confirm-modal" class="modal-overlay hidden">
      <div class="modal-content small-modal">
        <h3 data-i18n="modal_logout_title">Cerrar Sesi√≥n</h3>
        <p
          data-i18n="modal_logout_desc"
          style="
            margin-bottom: 20px;
            font-size: 0.95rem;
            color: var(--text-secondary);
          "
        >
          ¬øEst√°s seguro de que deseas salir?
        </p>
        <div class="modal-actions">
          <button id="btn-cancel-logout-modal" class="btn-secondary" data-i18n="btn_cancel">
            Cancelar
          </button>
          <button id="btn-confirm-logout-modal" class="btn-danger" data-i18n="btn_logout">
            Cerrar Sesi√≥n
          </button>
        </div>
      </div>
    </div>

    <!-- DELETE ACCOUNT CONFIRMATION MODAL -->
    <div id="delete-account-confirm-modal" class="modal-overlay hidden">
      <div class="modal-content small-modal" style="border: 2px solid #ff5555">
        <h3 style="color: #ff5555" data-i18n="modal_delete_confirm_title">‚ö†Ô∏è √öltima Advertencia</h3>
        <p
          data-i18n-html="modal_delete_confirm_desc"
          style="
            margin-bottom: 20px;
            font-size: 0.95rem;
            color: var(--text-secondary);
          "
        >
          Se borrar√° <b>todo tu progreso, estad√≠sticas y ranking</b> para
          siempre. Esta acci√≥n no se puede deshacer.
        </p>
        <div class="modal-actions">
          <button id="btn-cancel-delete-modal" class="btn-secondary" data-i18n="btn_cancel">
            Cancelar
          </button>
          <button
            id="btn-confirm-delete-modal"
            class="btn-delete-danger"
            style="background: #ff5555; color: white"
            data-i18n="btn_delete_all"
          >
            Borrar Todo
          </button>
        </div>
      </div>
    </div>

    <!-- VICTORY SUMMARY MODAL -->
    <div id="victory-summary-modal" class="modal-overlay hidden">
      <div class="modal-content glass-panel victory-summary-content">
        <div class="victory-summary-header">
          <h2 data-i18n="victory_title">¬°Juego Completado!</h2>
          <p class="modal-desc" data-i18n="victory_desc">Aqu√≠ tienes un resumen de tu partida de hoy.</p>
        </div>

        <div class="victory-stats-grid">
          <div class="victory-stat-card">
            <span class="stat-icon">‚è±Ô∏è</span>
            <div class="stat-info">
              <span class="stat-label" data-i18n="victory_stat_time">Tiempo Total</span>
              <span id="victory-total-time" class="stat-value">--:--</span>
            </div>
          </div>
          <div class="victory-stat-card">
            <span class="stat-icon">üî•</span>
            <div class="stat-info">
              <span class="stat-label" data-i18n="victory_stat_streak">Racha Actual</span>
              <span id="victory-streak" class="stat-value">--</span>
            </div>
          </div>
          <div class="victory-stat-card">
            <span class="stat-icon">‚ùå</span>
            <div class="stat-info">
              <span class="stat-label" data-i18n="victory_stat_errors">Errores</span>
              <span id="victory-errors" class="stat-value">0</span>
            </div>
          </div>
          <div class="victory-stat-card highlight">
            <span class="stat-icon">üèÜ</span>
            <div class="stat-info">
              <span class="stat-label" data-i18n="victory_stat_score">Puntaje</span>
              <span id="victory-score" class="stat-value">+0.0</span>
            </div>
          </div>
        </div>

        <div class="victory-breakdown">
          <h3 data-i18n="victory_times_breakdown">Tiempos por Minijuego</h3>
          <div id="victory-stage-times" class="stage-times-grid">
            <!-- Dynamically populated -->
          </div>
        </div>

        <div class="modal-actions">
          <button id="btn-victory-home" class="btn-primary" data-i18n="btn_back_home" style="width: 100%;">
            Volver al Inicio
          </button>
        </div>
      </div>
    </div>

    <!-- BUG REPORT MODAL -->
    <div id="report-bug-modal" class="modal-overlay hidden">
      <div class="modal-content glass-panel">
        <h3 data-i18n="modal_bug_title">Reportar Bug üêõ</h3>
        <p class="modal-desc" data-i18n="modal_bug_desc">
          Describe el problema que encontraste. Si es posible, menciona qu√©
          estabas haciendo cuando ocurri√≥.
        </p>
        <textarea
          id="bug-report-text"
          class="auth-input"
          style="
            min-height: 120px;
            margin: 15px 0;
            resize: vertical;
            font-family: inherit;
          "
          data-i18n-placeholder="modal_bug_placeholder"
          placeholder="Escribe aqu√≠ los detalles..."
        ></textarea>
        <div class="modal-actions">
          <button id="btn-cancel-bug" class="btn-secondary" data-i18n="btn_cancel">Cancelar</button>
          <button id="btn-submit-bug" class="btn-primary" data-i18n="btn_bug_submit">Enviar Reporte</button>
        </div>
      </div>
    </div>

    <!-- DEBUG HELP BUTTON (Beta Mode Only) -->
    <button
      id="debug-help-btn"
      class="debug-fab"
      title="Resolver paso actual (Beta)"
      style="display: none"
    >
      ü™Ñ
    </button>

    <!-- SCRIPTS -->
    <script type="module" src="js/home.js"></script>
    <script type="module" src="js/auth.js"></script>
  </body>
</html>
